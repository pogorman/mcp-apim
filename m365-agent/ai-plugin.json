{
  "$schema": "https://aka.ms/json-schemas/copilot/plugin/v2.4/schema.json",
  "schema_version": "v2.4",
  "name_for_human": "Philly Investigator",
  "description_for_human": "Philadelphia property ownership, violations, demolitions, assessments, and licenses.",
  "namespace": "philly",
  "runtimes": [
    {
      "type": "RemoteMCPServer",
      "spec": {
        "url": "https://philly-mcp-server.victoriouspond-48a6f41b.eastus2.azurecontainerapps.io/mcp"
      },
      "auth": {
        "type": "None"
      },
      "run_for_functions": [
        "search_entities",
        "get_entity_network",
        "get_property_profile",
        "get_property_violations",
        "get_property_assessments",
        "get_property_licenses",
        "get_property_appeals",
        "get_property_demolitions",
        "search_businesses",
        "get_top_violators",
        "get_area_stats",
        "run_query"
      ]
    }
  ],
  "functions": [
    {
      "name": "search_entities",
      "description": "Search for entities (people, LLCs, corporations) by name. Returns matching entities and how many properties they are linked to.",
      "parameters": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name or partial name to search for (e.g., 'GEENA LLC', 'WALSH')"
          },
          "limit": {
            "type": "string",
            "description": "Max results to return (default 50, max 200)"
          }
        },
        "required": ["name"]
      }
    },
    {
      "name": "get_entity_network",
      "description": "Get the full property network for an entity: all linked addresses, parcels, property details, and violation/demolition counts.",
      "parameters": {
        "type": "object",
        "properties": {
          "entityId": {
            "type": "string",
            "description": "The master_entity_id UUID from search_entities results"
          }
        },
        "required": ["entityId"]
      }
    },
    {
      "name": "get_property_profile",
      "description": "Get complete details for a property by parcel number: ownership, building info, market value, assessment, active licenses, and violation/demolition/appeal counts.",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number (e.g., '405100505')"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "get_property_violations",
      "description": "Get code enforcement case investigations for a property. Can filter by status (FAILED, PASSED, CLOSED). Supports pagination.",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number"
          },
          "status": {
            "type": "string",
            "description": "Filter by investigation status: FAILED, PASSED, CLOSED"
          },
          "offset": {
            "type": "string",
            "description": "Pagination offset (default 0)"
          },
          "limit": {
            "type": "string",
            "description": "Results per page (default 100, max 500)"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "get_property_assessments",
      "description": "Get the assessment history for a property showing market value, taxable amounts, and exemptions by year (2015-2025).",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "get_property_licenses",
      "description": "Get all business and commercial activity licenses associated with a property. Shows rental licenses, vacant property licenses, and any commercial operations.",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "get_property_appeals",
      "description": "Get all L&I appeals filed for a property. Shows appeal type, status, decision, appellant, and related case files.",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "get_property_demolitions",
      "description": "Get demolition records for a property. Shows whether demolition was city-initiated (taxpayer-funded) or owner-initiated, contractor info, and status.",
      "parameters": {
        "type": "object",
        "properties": {
          "parcelNumber": {
            "type": "string",
            "description": "The OPA parcel number"
          }
        },
        "required": ["parcelNumber"]
      }
    },
    {
      "name": "search_businesses",
      "description": "Search business and commercial activity licenses by keyword, type, or zip code. Find check cashing, pawn shops, title loans, dollar stores, and other businesses.",
      "parameters": {
        "type": "object",
        "properties": {
          "keyword": {
            "type": "string",
            "description": "Business name keyword (e.g., 'check cashing', 'pawn', 'dollar')"
          },
          "licensetype": {
            "type": "string",
            "description": "License type filter (e.g., 'Rental', 'Food', 'Vacant')"
          },
          "zip": {
            "type": "string",
            "description": "Zip code filter (e.g., '19134')"
          },
          "limit": {
            "type": "string",
            "description": "Max results (default 50, max 200)"
          }
        }
      }
    },
    {
      "name": "get_top_violators",
      "description": "Get the ranked list of property owners with the most code violations across their portfolio. Filters by minimum property count and entity type.",
      "parameters": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "string",
            "description": "Number of results (default 25, max 100)"
          },
          "minProperties": {
            "type": "string",
            "description": "Minimum properties to qualify (default 5)"
          },
          "entityType": {
            "type": "string",
            "description": "Filter: 'llc' for corporate entities only, omit for all"
          }
        }
      }
    },
    {
      "name": "get_area_stats",
      "description": "Get aggregate statistics for a Philadelphia zip code: property counts, vacancy rates, violation rates, demolitions, license counts, and top property owners.",
      "parameters": {
        "type": "object",
        "properties": {
          "zipCode": {
            "type": "string",
            "description": "5-digit zip code (e.g., '19134')"
          }
        },
        "required": ["zipCode"]
      }
    },
    {
      "name": "run_query",
      "description": "Execute a custom read-only SQL query against the Philadelphia property database. Must be a SELECT with TOP(n) or OFFSET/FETCH. Max 1000 rows.",
      "parameters": {
        "type": "object",
        "properties": {
          "sql": {
            "type": "string",
            "description": "SQL SELECT query. Must include TOP(n) or OFFSET/FETCH. Max 1000 rows."
          }
        },
        "required": ["sql"]
      }
    }
  ]
}
